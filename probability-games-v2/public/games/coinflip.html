<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Coin Flip ‚Äì Probability Games v2</title>
  <meta
    name="description"
    content="Bet on heads or tails, flip a coin, and see how streaks and house edge behave over time."
  />

  <meta property="og:type" content="website" />
  <meta property="og:title" content="Coin Flip ‚Äì Probability Games v2" />
  <meta
    property="og:description"
    content="Double-or-nothing style coin flips with a transparent house edge and streak tracking."
  />
  <meta property="og:image" content="../assets/icon.svg" />
  <meta name="twitter:card" content="summary_large_image" />

  <link rel="icon" type="image/svg+xml" href="../assets/icon.svg" />
  <link rel="apple-touch-icon" href="../assets/icon.svg" />

  <link rel="stylesheet" href="../../src/styles/base.css" />
  <link rel="stylesheet" href="../../src/styles/theme.css" />
  <link rel="stylesheet" href="../../src/games/coinflip/coinflip.css" />
</head>
<body>
  <header class="pg-header">
    <h1>ü™ô Coin Flip</h1>
    <p class="pg-subtitle">
      Bet on heads or tails, flip a coin, and watch streaks emerge.
    </p>
    <a class="pg-link" href="../index.html">‚Üê Back to hub</a>

    <nav class="pg-nav">
      <a class="pg-nav-link" href="../index.html">Games hub</a>
      <a class="pg-nav-link" href="../../docs/index.html">Project docs</a>
    </nav>
  </header>

  <main class="pg-main pg-main-narrow">
    <div class="game-info-row">
      <button id="coin-info-open" class="game-info-btn">
        How this game works
      </button>
    </div>

    <section class="coin-layout">
      <!-- Left: controls -->
      <div class="coin-panel">
        <div class="coin-balance-box" id="coin-balance-box">
          <span>Balance</span>
          <strong id="coin-balance">1,000</strong>
          <span class="coin-currency">coins</span>
        </div>

        <div class="coin-field">
          <label for="coin-bet">Bet per flip</label>
          <div class="coin-input-row">
            <input
              id="coin-bet"
              type="number"
              min="1"
              step="1"
              value="10"
            />
            <button id="coin-bet-min" class="coin-btn-secondary">Min</button>
            <button id="coin-all-in" class="coin-btn-secondary">All in</button>
          </div>
        </div>

        <div class="coin-field">
          <label>Choose side</label>
          <div class="coin-side-toggle">
            <button
              class="coin-side-btn coin-side-btn--active"
              data-side="heads"
              id="coin-side-heads"
            >
              Heads
            </button>
            <button
              class="coin-side-btn"
              data-side="tails"
              id="coin-side-tails"
            >
              Tails
            </button>
          </div>
          <p class="coin-meta">
            Fair 50/50 coin with <span id="coin-multiplier">1.96x</span> payout
            on a win. House edge:
            <span id="coin-edge">2.0%</span> (EV:
            <span id="coin-ev-text">‚àí2.0%</span> per bet).
          </p>
        </div>

        <div class="coin-field">
          <label>Auto flip (simulation)</label>
          <div class="coin-input-row">
            <button
              class="coin-btn-secondary coin-auto-btn"
              data-count="10"
            >
              10 flips
            </button>
            <button
              class="coin-btn-secondary coin-auto-btn"
              data-count="50"
            >
              50 flips
            </button>
            <button
              class="coin-btn-secondary coin-auto-btn"
              data-count="100"
            >
              100 flips
            </button>
          </div>
          <div class="coin-input-row">
            <button
              id="coin-auto-stop"
              class="coin-btn-secondary coin-auto-stop"
              disabled
            >
              Stop auto
            </button>
          </div>
          <p class="coin-meta">
            Uses your current bet and side, then runs multiple flips to
            highlight variance and streaks.
          </p>
        </div>

        <button id="coin-flip" class="coin-btn-primary">Flip coin</button>

        <p id="coin-message" class="coin-message">
          Pick a side, set your bet, then flip.
        </p>
      </div>

      <!-- Right: visual + history -->
      <div class="coin-panel coin-right-panel">
        <div class="coin-display-wrapper">
          <div class="coin-display">
            <div class="coin-circle" id="coin-circle">H</div>
            <div class="coin-shadow"></div>
          </div>
        </div>

        <div class="coin-history">
          <div class="coin-history-header">
            <h2>Stats this session</h2>
            <span id="coin-stats-summary">
              Flips: 0 ‚Ä¢ Win rate: 0.0% ‚Ä¢ Heads: 0 ‚Ä¢ Tails: 0 ‚Ä¢ Streak: ‚Äì
            </span>
          </div>
          <ul id="coin-history-list"></ul>
        </div>
      </div>
    </section>
  </main>

  <!-- All-in dialog -->
  <div class="coin-dialog-backdrop" id="coin-dialog">
    <div class="coin-dialog">
      <h2>Go all in?</h2>
      <p>
        You are about to bet your entire balance on a single coin flip. One bad
        outcome can wipe you out.
      </p>
      <div class="coin-dialog-actions">
        <button id="coin-confirm-all-in" class="coin-btn-primary">Yes</button>
        <button id="coin-cancel-all-in" class="coin-btn-secondary">
          Cancel
        </button>
      </div>
    </div>
  </div>

  <!-- Info panel -->
  <div class="game-info-panel" id="coin-info-panel">
    <div class="game-info-panel-inner">
      <button
        type="button"
        id="coin-info-close"
        class="game-info-close"
        aria-label="Close"
      >
        √ó
      </button>
      <h2>How the Coin Flip game works</h2>
      <p>
        You choose <strong>heads</strong> or <strong>tails</strong>, set a bet,
        and flip a fair coin (50/50).
      </p>

      <h3>Mechanics</h3>
      <ul>
        <li>Pick a side: heads or tails.</li>
        <li>Set a bet amount using the shared wallet.</li>
        <li>Flip the coin: we draw a 50/50 outcome.</li>
        <li>
          If the coin matches your choice, you win with a
          <strong>1.96x</strong> payout.
        </li>
        <li>If it doesn‚Äôt match, you lose your full bet.</li>
      </ul>

      <h3>House edge & expected value</h3>
      <p>
        A perfectly fair double-or-nothing coin would pay <code>2.00x</code>
        for a 50% win chance (EV = 0). Here we use a small
        <strong>2% house edge</strong>.
      </p>
      <p>
        With a 50% win chance, <code>fair multiplier = 1 / 0.5 = 2.00x</code>.
        We then multiply by <code>(1 ‚àí 0.02)</code> to apply the edge, giving
        <strong>1.96x</strong>. The expected value of each bet is
        <code>0.5 √ó 1.96 ‚àí 1 ‚âà ‚àí0.02</code>, or about ‚àí2% per bet.
      </p>

      <h3>What to look at</h3>
      <ul>
        <li>Short streaks of wins and losses in the history.</li>
        <li>
          How your <strong>session win rate</strong> compares to the ideal 50%.
        </li>
        <li>
          How auto flips (10/50/100) drift towards the theoretical edge, but
          never perfectly match it over finite samples.
        </li>
      </ul>
    </div>
  </div>

  <script type="module" src="../../src/games/coinflip/coinflip.js"></script>
</body>
</html>
